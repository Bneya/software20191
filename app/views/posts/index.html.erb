<!-- Estas líneas se deben borrar luego, son solo hasta que exista current_user y la implementación devise -->
<!-- -----------------------------------------------------------------------------------  -->
<% connected = current_user %>
<% if connected %><% isadmin = (current_user.has_role? :admin) %><% end %>

<p id="notice"><%= notice %></p>

<h1>Lista de todos los Posts</h1>

Esta es solo una lista de administración. Para crear un post es necesario ir al muro de ese curso.

<br><br><br>

<% if (connected && isadmin) %>

  <table class="table table-hover">
    <thead class="thead-dark">
      <tr>
        <th>User</th>
        <th>Course</th>
        <th>Content</th>
        <th>Title</th>
        <th>Rate</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @posts.each do |post| %>
        <tr>
          <td><%= post.user_id %></td>
          <td><%= post.course_id %></td>
          <td><%= strip_tags(post.content)[0..200] + " ..." %></td>
          <td><%= post.title %></td>
          <td><%= post.rate %></td>
          <td><%= link_to 'Show', post %></td>
          <td><%= link_to 'Edit', edit_post_path(post) %></td>
          <td><%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

<br>

<% else %>
  <div class="errorcustom"> ERROR: Solo los administradores pueden ver todos los posts </div>

<% end %>

<%= link_to 'Volver a la lista de cursos', courses_path %>
